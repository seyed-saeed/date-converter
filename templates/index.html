<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>تبدیل تاریخ و اوقات شرعی | ابزار آنلاین</title>
  <meta name="description" content="تبدیل تاریخ شمسی به میلادی و قمری + محاسبه سن + نمایش اوقات شرعی امروز.">
  <meta name="keywords" content="تبدیل تاریخ, شمسی, میلادی, قمری, اوقات شرعی, اذان, تقویم فارسی">
  <meta name="author" content="Seyed Saeed">
  <link rel="stylesheet" href="static/style.css">
  <link rel="icon" href="static/favicon.ico" type="image/x-icon">
</head>
<body>
  <div class="container">
    <h1>تبدیل تاریخ و اوقات شرعی</h1>

    <!-- فرم تبدیل تاریخ -->
    <form method="POST">
      <input type="hidden" name="action" value="convert">
      <div class="row">
        <label for="year">سال:</label>
        <select name="year" id="year">
          {% for y in years %}
            <option value="{{ y }}">{{ y }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="row">
        <label for="month">ماه:</label>
        <select name="month" id="month">
          {% for num, name in shamsi_months.items() %}
            <option value="{{ num }}">{{ name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="row">
        <label for="day">روز:</label>
        <select name="day" id="day">
          {% for d in days %}
            <option value="{{ d }}">{{ d }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="buttons">
        <button type="submit">🔄 تبدیل</button>
      </div>
    </form>

    {% if result and result.action == "convert" %}
      <div class="result">
        {% if result.error %}
          <p class="error">{{ result.error }}</p>
        {% else %}
          <p>📅 تاریخ شمسی: <strong>{{ result.shamsi }}</strong></p>
          <p>📆 تاریخ میلادی: <strong>{{ result.miladi }}</strong></p>
          <p>🌙 تاریخ قمری: <strong>{{ result.hijri }}</strong></p>
          <p>🗓 روز هفته: <strong>{{ result.weekday }}</strong></p>
          <p>🪐 نماد ماه: <strong>{{ result.month_symbol }}</strong></p>
          <p>📆 تعداد روزهای گذشته از این تاریخ: <strong>{{ result.age_days }}</strong> روز</p>
          {% if result.age %}
            <p>🎂 سن دقیق: <strong>{{ result.age }}</strong></p>
          {% endif %}
        {% endif %}
      </div>
    {% endif %}

    <!-- دکمه‌های اصلی -->
    <div class="buttons">
      <form method="POST">
        <input type="hidden" name="action" value="today">
        <button type="submit">📅 امروز</button>
      </form>

      <button type="button" onclick="showPrayerForm()">🕌 اوقات شرعی</button>
      <button type="button" onclick="showTimeForm()">🕒 ساعت کشور</button>
    </div>

    {% if result and result.action == "today" %}
      <div class="result">
        {% if result.error %}
          <p class="error">{{ result.error }}</p>
        {% else %}
          <p>📌 {{ result.today_text }}</p>
          <p>🌙 تاریخ قمری: <strong>{{ result.hijri_today }}</strong></p>
        {% endif %}
      </div>
    {% endif %}

    <!-- فرم مخفی‌شده برای وارد کردن شهر -->
    <form method="POST" id="prayer-form" style="display: none;">
      <input type="hidden" name="action" value="prayer">
      <div class="row">
        <label for="city">نام شهر:</label>
        <input type="text" name="city" id="city" placeholder="مثلاً Mashhad">
      </div>
      <div class="buttons">
        <button type="submit">تأیید</button>
      </div>
    </form>

    {% if result and result.action == "prayer" %}
      <div class="result">
        {% if result.error %}
          <p class="error">{{ result.error }}</p>
        {% else %}
          <h3>🕌 اوقات شرعی امروز در {{ result.city_name }}</h3>
          <p>اذان صبح: {{ result.prayer_times.Fajr }}</p>
          <p>طلوع آفتاب: {{ result.prayer_times.Sunrise }}</p>
          <p>اذان ظهر: {{ result.prayer_times.Dhuhr }}</p>
          <p>اذان عصر: {{ result.prayer_times.Asr }}</p>
          <p>اذان مغرب: {{ result.prayer_times.Maghrib }}</p>
          <p>اذان عشاء: {{ result.prayer_times.Isha }}</p>
        {% endif %}
      </div>
    {% endif %}

    <!-- فرم مخفی‌شده برای وارد کردن کشور -->
    <form method="POST" id="time-form" style="display: none;">
      <input type="hidden" name="action" value="time">
      <div class="row">
        <label for="country">نام کشور:</label>
        <input type="text" name="country" id="country" placeholder="مثلاً Japan یا ژاپن">
      </div>
      <div class="buttons">
        <button type="submit">تأیید</button>
      </div>
    </form>

    {% if result and result.action == "time" %}
      <div class="result">
        {% if result.error %}
          <p class="error">{{ result.error }}</p>
        {% else %}
          <h3>🕒 ساعت فعلی در {{ result.country_name }}</h3>
          <p>{{ result.local_time }}</p>
        {% endif %}
      </div>
    {% endif %}
  </div>

  <script>
    function showPrayerForm() {
      document.getElementById("prayer-form").style.display = "block";
    }
    function showTimeForm() {
      document.getElementById("time-form").style.display = "block";
    }
  </script>
</body>
</html>
